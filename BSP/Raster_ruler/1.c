RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM3, ENABLE); //????

RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA, ENABLE);

GPIO_InitStructure.GPIO_Pin = GPIO_Pin_7; //GPIO??
PIO_InitStructure.GPIO_Mode = GPIO_Mode_IN_FLOATING;
GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
GPIO_Init(GPIOA, &GPIO_InitStructure);

NVIC_InitStructure.NVIC_IRQChannel = TIM3_IRQn; //NVIC??
NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0;
NVIC_InitStructure.NVIC_IRQChannelSubPriority = 1;
NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
NVIC_Init(&NVIC_InitStructure);
TIM_ICInitStructure.TIM_Channel = TIM_Channel_2; //????
TIM_ICInitStructure.TIM_ICPolarity = TIM_ICPolarity_Rising; //?????
TIM_ICInitStructure.TIM_ICSelection = TIM_ICSelection_DirectTI; //??????????
TIM_ICInitStructure.TIM_ICPrescaler = TIM_ICPSC_DIV1; //????????????????????????,??

TIM_ICInitStructure.TIM_ICFilter = 0x0; //????,??????????????0x0~0xF
TIM_PWMIConfig(TIM3, &TIM_ICInitStructure); //??????TIM????

TIM_SelectInputTrigger(TIM3, TIM_TS_TI2FP2); //??IC2??????

TIM_SelectSlaveMode(TIM3, TI***aveMode_Reset);//TIM???:???????????????????????????

TIM_SelectMasterSlaveMode(TIM3, TIM_MasterSlaveMode_Enable); //??????????

TIM_Cmd(TIM3, ENABLE); //??TIM2

TIM_ITConfig(TIM3, TIM_IT_CC2, ENABLE); //????

void TIM3_IRQHandler(void)
{
	TIM_ClearITPendingBit(TIM3, TIM_IT_CC2); //??TIM???????

	IC2Value = TIM_GetCapture2(TIM3); //??IC2???????,??PWM??????
	if (IC2Value != 0)
	{
		DutyCycle = (TIM_GetCapture1(TIM3) * 100) / IC2Value; //??IC1???????,??????

		Frequency = 72000000 / IC2Value; //??PWM???
	}
	else
	{
		DutyCycle = 0;
		Frequency = 0;
	}
}

TIM_TimeBaseStructure.TIM_Period = 0xFFFF; //??0~FFFF
TIM_TimeBaseStructure.TIM_Prescaler = 5; //????,????5+1?6??
TIM_TimeBaseStructure.TIM_ClockDivision = 0; //????
TIM_TimeBaseStructure.TIM_CounterMode = TIM_CounterMode_Up;//??
TIM_TimeBaseInit(TIM2, &TIM_TimeBaseStructure);//?????
